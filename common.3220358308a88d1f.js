"use strict";(self.webpackChunkadmin_panel=self.webpackChunkadmin_panel||[]).push([[592],{3432:(g,T,i)=>{i.d(T,{S:()=>u});var o=i(2560),a=i(8873),p=i(6413),c=i(3609),h=i(2673),m=i(635),A=i(9345),S=i(9785);class l{constructor(){this.firestore=(0,o.f3M)(a.gg),this.teacherCollection=(0,a.hJ)(this.firestore,A.F.TEACHER),this.userApiService=(0,o.f3M)(S.Q)}getTeachers(){const e=(0,a.IO)(this.teacherCollection,(0,a.ar)("is_active","==",!0));return(0,c.D)((0,a.PL)(e)).pipe((0,h.w)(r=>{const s=r.docs.map(d=>d.data()),v=s.reduce((d,t)=>({...d,[t.uid]:t}),{}),U=s.map(d=>d.uid);return this.userApiService.getUsersInList(U).pipe((0,m.U)(d=>d.map(t=>({uid:v[t.uid].uid,phone:t.phone,email:t.email,first_name:t.first_name,middle_name:t.middle_name,last_name:t.last_name,avatar_url:t.avatar_urls?t.avatar_urls[0]:"",start_date:v[t.uid].start_date,styles:v[t.uid].styles,level:v[t.uid].level}))))}))}getTeacher(e){const n=(0,a.JU)(this.teacherCollection,e);return(0,c.D)((0,a.QT)(n)).pipe((0,m.U)(r=>r.data()),(0,h.w)(r=>this.userApiService.getUser(r.uid).pipe((0,m.U)(s=>({uid:r.uid,phone:s.phone,email:s.email,first_name:s.first_name,middle_name:s.middle_name,last_name:s.last_name,avatar_url:s.avatar_urls[0],start_date:r.start_date,styles:r.styles,level:r.level})))))}addTeacher(e){const n=(0,a.JU)(this.teacherCollection,e.uid);return(0,c.D)((0,a.QT)(n)).pipe((0,h.w)(r=>(e.updated_on=p.EK.now(),e.start_date=p.EK.now(),r.exists()?(0,c.D)((0,a.r7)(n,e)):(e.created_on=p.EK.now(),(0,c.D)((0,a.pl)(n,e))))),(0,h.w)(()=>this.userApiService.updateUser({uid:e.uid,is_teacher:!0})))}removeTeacher(e){const n=(0,a.JU)(this.teacherCollection,e.uid);return e.updated_on=p.EK.now(),e.end_date=p.EK.now(),(0,c.D)((0,a.r7)(n,{uid:e.uid,is_active:!1,updated_on:e.updated_on,end_date:e.end_date})).pipe((0,h.w)(()=>this.userApiService.updateUser({uid:e.uid,is_teacher:!1})))}}l.\u0275fac=function(e){return new(e||l)},l.\u0275prov=o.Yz7({token:l,factory:l.\u0275fac,providedIn:"root"});class u{constructor(){this.teacherApiService=(0,o.f3M)(l),this.userApiService=(0,o.f3M)(S.Q)}getList(){return this.teacherApiService.getTeachers()}getUsers(){return this.userApiService.getUsersNotTeachers()}addTeacher(e){return this.teacherApiService.addTeacher(e)}removeTeacher(e){return this.teacherApiService.removeTeacher(e)}}u.\u0275fac=function(e){return new(e||u)},u.\u0275prov=o.Yz7({token:u,factory:u.\u0275fac,providedIn:"root"})}}]);
//# sourceMappingURL=common.3220358308a88d1f.js.map