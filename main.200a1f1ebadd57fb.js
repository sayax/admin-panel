"use strict";(self.webpackChunkadmin_panel=self.webpackChunkadmin_panel||[]).push([[179],{9345:(g,h,e)=>{var c,t;e.d(h,{F:()=>c}),(t=c||(c={})).PROFILE="profile",t.TEACHER="teacher",t.EVENTS="events",t.EVENT_SCHEDULES="schedules",t.ACL="ACL"},3954:(g,h,e)=>{e.d(h,{y:()=>s});var c=e(2560),t=e(7204),i=e(3609);class s{constructor(){this.fireStorage=(0,c.f3M)(t.Ke)}uploadFile(u,m){if(!u)throw new Error("File not provided");const p=(0,t.iH)(this.fireStorage,`${m}/${Date.now()}-${u.name}`),v=(0,t.KV)(p,u);return(0,i.D)(v)}getMedia(u){const m=(0,t.iH)(this.fireStorage,u);return(0,i.D)((0,t.Jt)(m))}}s.\u0275fac=function(u){return new(u||s)},s.\u0275prov=c.Yz7({token:s,factory:s.\u0275fac,providedIn:"root"})},9785:(g,h,e)=>{e.d(h,{Q:()=>v});var c=e(2560),t=e(8873),i=e(6413),s=e(3609),r=e(635),u=e(745),m=e(2673),p=e(9345);class v{constructor(){this.firestore=(0,c.f3M)(t.gg),this.profileCollection=(0,t.hJ)(this.firestore,p.F.PROFILE)}getUsers(){const l=(0,t.IO)(this.profileCollection);return(0,s.D)((0,t.PL)(l)).pipe((0,r.U)(f=>f.docs.map(a=>a.data())))}getUsersNotTeachers(){const l=(0,t.IO)(this.profileCollection,(0,t.ar)("is_blocked","==",!1),(0,t.ar)("is_teacher","==",!1));return(0,s.D)((0,t.PL)(l)).pipe((0,r.U)(f=>f.docs.map(a=>a.data())))}getUsersInList(l){if(!l||!l.length)return(0,u.of)([]);const f=(0,t.IO)(this.profileCollection,(0,t.ar)("uid","in",l));return(0,s.D)((0,t.PL)(f)).pipe((0,r.U)(A=>A.docs.map(O=>O.data())))}getUser(l){const f=(0,t.JU)(this.profileCollection,l);return(0,s.D)((0,t.QT)(f)).pipe((0,r.U)(a=>a.data()))}getUserChanges(l){const f=(0,t.JU)(this.profileCollection,l);return(0,t.KO)(f).pipe((0,r.U)(a=>a.data()))}updateUser(l){const f=(0,t.JU)(this.profileCollection,l.uid);return(0,s.D)((0,t.QT)(f)).pipe((0,m.w)(a=>(l.updated_on=i.EK.now(),a.exists()?(0,s.D)((0,t.r7)(f,l)):(l.created_on=i.EK.now(),(0,s.D)((0,t.pl)(f,l))))))}}v.\u0275fac=function(l){return new(l||v)},v.\u0275prov=c.Yz7({token:v,factory:v.\u0275fac,providedIn:"root"})},8217:(g,h,e)=>{e.d(h,{B:()=>s});var c=e(2560),t=e(745),i=e(3954);class s{constructor(){this.mediaService=(0,c.f3M)(i.y)}transform(u){return u?this.mediaService.getMedia(u):(0,t.of)("")}}s.\u0275fac=function(u){return new(u||s)},s.\u0275pipe=c.Yjl({name:"mediaUrl",type:s,pure:!0})},8915:(g,h,e)=>{e.d(h,{e:()=>i});var c=e(2560),t=e(9785);class i{constructor(){this.userApiService=(0,c.f3M)(t.Q)}getUser(r){return this.userApiService.getUser(r)}getUserChanges(r){return this.userApiService.getUserChanges(r)}}i.\u0275fac=function(r){return new(r||i)},i.\u0275prov=c.Yz7({token:i,factory:i.\u0275fac,providedIn:"root"})},4466:(g,h,e)=>{e.d(h,{m:()=>i});var c=e(4666),t=e(2560);class i{}i.\u0275fac=function(r){return new(r||i)},i.\u0275mod=t.oAB({type:i}),i.\u0275inj=t.cJS({imports:[c.ez]})},8027:(g,h,e)=>{var c=e(4497),t=e(2560),i=e(7954),s=e(6906),r=e(7091),u=e(4164),m=e(9337);class p{constructor(){this.authService=(0,t.f3M)(u._o),this.router=(0,t.f3M)(r.F0)}canActivate(n,d){return this.authService.isAuthenticated().pipe((0,m.b)(y=>{y||this.router.navigate(["/auth"])}))}}p.\u0275fac=function(n){return new(n||p)},p.\u0275prov=t.Yz7({token:p,factory:p.\u0275fac,providedIn:"root"});const v=[{path:"",loadChildren:()=>e.e(113).then(e.bind(e,9113)).then(o=>o.DashboardModule)},{path:"auth",loadChildren:()=>e.e(845).then(e.bind(e,7845)).then(o=>o.LoginModule)},{path:"profile",loadChildren:()=>e.e(765).then(e.bind(e,4765)).then(o=>o.ProfileModule),canActivate:[p]},{path:"teacher",loadChildren:()=>e.e(42).then(e.bind(e,3042)).then(o=>o.TeacherModule),canActivate:[p]},{path:"calendar",loadChildren:()=>Promise.all([e.e(592),e.e(181)]).then(e.bind(e,9181)).then(o=>o.AppCalendarModule),canActivate:[p]},{path:"event",loadChildren:()=>Promise.all([e.e(592),e.e(147)]).then(e.bind(e,7147)).then(o=>o.EventModule),canActivate:[p]}];class M{}M.\u0275fac=function(n){return new(n||M)},M.\u0275mod=t.oAB({type:M}),M.\u0275inj=t.cJS({imports:[r.Bz.forRoot(v),r.Bz]});var l=e(116),f=e(635),a=e(1008),A=e(4666),O=e(2673),Z=e(4874),x=e(745),K=e(8915),F=e(8217);function W(o,n){if(1&o){const d=t.EpF();t.TgZ(0,"button",4),t.NdJ("click",function(){t.CHM(d);const X=t.oxw();return t.KtG(X.toggle())}),t._UZ(1,"nb-icon",5),t.qZA()}}const z=function(){return["/auth"]};function H(o,n){1&o&&(t.TgZ(0,"a",6),t._UZ(1,"nb-icon",7),t.qZA()),2&o&&t.Q6J("routerLink",t.DdM(1,z))}function J(o,n){if(1&o&&(t._UZ(0,"nb-user",9),t.ALo(1,"async"),t.ALo(2,"mediaUrl")),2&o){const d=n.ngIf;t.Q6J("picture",d.avatar_urls&&t.lcZ(1,2,t.lcZ(2,4,d.avatar_urls[0]))||"")("name",d.first_name)}}function $(o,n){if(1&o&&(t.YNc(0,J,3,6,"nb-user",8),t.ALo(1,"async")),2&o){const d=t.oxw();t.Q6J("ngIf",t.lcZ(1,1,d.user$))}}class C{constructor(){this.sidebarService=(0,t.f3M)(a.lzT),this.nbAuthService=(0,t.f3M)(u._o),this.route=(0,t.f3M)(r.gz),this.router=(0,t.f3M)(r.F0),this.authService=(0,t.f3M)(K.e),this.isLoggedIn$=this.nbAuthService.isAuthenticated(),this.user$=this.nbAuthService.getToken().pipe((0,O.w)(n=>(console.log({user:n}),this.authService.getUserChanges(n.getPayload().user_id)))),this.title$=this.router.events.pipe((0,l.h)(n=>n instanceof r.m2),(0,Z.O)(this.router),(0,O.w)(()=>{let n=this.route.firstChild;for(;n?.firstChild;)n=n.firstChild;return n?.data??(0,x.of)({title:"Admin"})}),(0,f.U)(n=>n.title))}ngOnInit(){this.router.events.pipe((0,l.h)(n=>n instanceof r.m2),(0,m.b)(()=>{this.sidebarService.collapse()})).subscribe()}toggle(){this.sidebarService.toggle()}}function j(o,n){1&o&&(t.TgZ(0,"nb-layout-header",3),t._UZ(1,"app-header"),t.qZA())}C.\u0275fac=function(n){return new(n||C)},C.\u0275cmp=t.Xpm({type:C,selectors:[["app-header"]],decls:10,vars:10,consts:[["nbButton","","status","basic","size","tiny","class","burger",3,"click",4,"ngIf"],[1,"navigation"],["class","login","nbButton","","status","basic","size","tiny",3,"routerLink",4,"ngIf","ngIfElse"],["loggedIn",""],["nbButton","","status","basic","size","tiny",1,"burger",3,"click"],["icon","menu-outline"],["nbButton","","status","basic","size","tiny",1,"login",3,"routerLink"],["icon","person-outline"],[3,"picture","name",4,"ngIf"],[3,"picture","name"]],template:function(n,d){if(1&n&&(t.YNc(0,W,2,0,"button",0),t.ALo(1,"async"),t.TgZ(2,"h1"),t._uU(3),t.ALo(4,"async"),t.qZA(),t.TgZ(5,"div",1),t.YNc(6,H,2,2,"a",2),t.ALo(7,"async"),t.YNc(8,$,2,3,"ng-template",null,3,t.W1O),t.qZA()),2&n){const y=t.MAs(9);t.Q6J("ngIf",t.lcZ(1,4,d.isLoggedIn$)),t.xp6(3),t.Oqu(t.lcZ(4,6,d.title$)),t.xp6(3),t.Q6J("ngIf",!t.lcZ(7,8,d.isLoggedIn$))("ngIfElse",y)}},dependencies:[A.O5,r.rH,a.fMN,a.DPz,a.k0$,A.Ov,F.B],styles:["[_nghost-%COMP%]{display:flex;align-items:center;width:100%}.navigation[_ngcontent-%COMP%]{margin-left:auto}.burger[_ngcontent-%COMP%]{--button-filled-basic-background-color: transparent;--button-filled-basic-hover-background-color: transparent;--button-filled-basic-focus-background-color: transparent;margin-right:16px}.burger[_ngcontent-%COMP%]   nb-icon[_ngcontent-%COMP%]{--button-tiny-icon-size: 20px}.login[_ngcontent-%COMP%]{--button-filled-basic-background-color: transparent;--button-filled-basic-hover-background-color: transparent;--button-filled-basic-focus-background-color: transparent;text-transform:lowercase}.login[_ngcontent-%COMP%]   nb-icon[_ngcontent-%COMP%]{--button-tiny-icon-size: 20px}"],changeDetection:0});class P{constructor(){this.title="admin-panel",this.items=[{title:"\u0413\u043b\u0430\u0432\u043d\u0430\u044f",link:"/"},{title:"\u041f\u0440\u043e\u0444\u0438\u043b\u044c",link:"/profile",pathMatch:"full"},{title:"\u0421\u043e\u0431\u044b\u0442\u0438\u044f",link:"/event",pathMatch:"prefix"},{title:"\u041a\u0430\u043b\u0435\u043d\u0434\u0430\u0440\u044c",link:"/calendar",pathMatch:"full"},{title:"\u0421\u043f\u0438\u0441\u043e\u043a \u043f\u0440\u0435\u043f\u043e\u0434\u0430\u0432\u0430\u0442\u0435\u043b\u0435\u0439",link:"/teacher",pathMatch:"prefix"},{title:"\u0421\u043f\u0438\u0441\u043e\u043a \u0443\u0447\u0435\u043d\u0438\u043a\u043e\u0432",link:"/student",pathMatch:"full"},{title:"\u041a\u043e\u043d\u0442\u0430\u043a\u0442\u044b",link:"/contact",pathMatch:"full"},{title:"\u041e \u043d\u0430\u0441",link:"/about",pathMatch:"full"},{title:"\u0412\u044b\u0439\u0442\u0438",link:"/auth/logout"}],this.router=(0,t.f3M)(r.F0),this.sidebarService=(0,t.f3M)(a.lzT),this.hasHeader$=this.router.events.pipe((0,l.h)(n=>n instanceof r.m2),(0,f.U)(n=>n.url),(0,f.U)(n=>{const d=!n.includes("auth");return d||this.sidebarService.collapse(),d}))}}P.\u0275fac=function(n){return new(n||P)},P.\u0275cmp=t.Xpm({type:P,selectors:[["app-root"]],decls:8,vars:8,consts:[["fixed","",4,"ngIf"],["state","collapsed"],[3,"items"],["fixed",""]],template:function(n,d){1&n&&(t.TgZ(0,"nb-layout"),t.YNc(1,j,2,0,"nb-layout-header",0),t.ALo(2,"async"),t.TgZ(3,"nb-sidebar",1),t._UZ(4,"nb-menu",2),t.qZA(),t.TgZ(5,"nb-layout-column"),t.ALo(6,"async"),t._UZ(7,"router-outlet"),t.qZA()()),2&n&&(t.xp6(1),t.Q6J("ngIf",t.lcZ(2,4,d.hasHeader$)),t.xp6(3),t.Q6J("items",d.items),t.xp6(1),t.ekj("main-layout",t.lcZ(6,6,d.hasHeader$)))},dependencies:[A.O5,r.lC,a.Aqw,a.dP_,a.dmS,a.nZR,a.mBz,C,A.Ov],styles:["nb-sidebar[_ngcontent-%COMP%], nb-sidebar[_ngcontent-%COMP%] > div.main-container[_ngcontent-%COMP%]{transition:width .3s}.main-layout[_ngcontent-%COMP%]{--layout-padding: 1rem}"]});var D=e(9674);const U={firebase:{projectId:"adminpanelfire",appId:"1:459068437086:web:9a4362f897fc83db06bacf",storageBucket:"adminpanelfire.appspot.com",apiKey:"AIzaSyCPPEzrugMj8qBy_XV11rpre81fj_fJGK0",authDomain:"adminpanelfire.firebaseapp.com",messagingSenderId:"459068437086"}};var I=e(3291),L=e(8563),T=e(8873),S=e(4849),b=e(7204),Q=e(9906),N=e(9557),R=e(6069),Y=e(1879),V=e(4466),B=e(1242),G=e(5498);(0,A.qS)(i.Z,"ru"),(0,A.qS)(s.Z);class E{}E.\u0275fac=function(n){return new(n||E)},E.\u0275mod=t.oAB({type:E,bootstrap:[P]}),E.\u0275inj=t.cJS({providers:[{provide:Y.Dh,useValue:U.firebase},{provide:t.soG,useValue:"ru"}],imports:[c.b2,M,(0,D.hX)(()=>(0,D.ZF)(U.firebase)),(0,I.AR)(()=>(0,I.v0)()),(0,L.v8)(()=>(0,L.N8)()),(0,T.Cm)(()=>(0,T.ad)()),(0,S.W$)(()=>(0,S.$C)()),(0,b.Vq)(()=>(0,b.cF)()),Q.rT,a.SDF.forRoot({name:"default"}),R.Nk,u.S.forRoot({forms:{login:{strategy:"password",rememberMe:!0,socialLinks:[]},register:{strategy:"password",terms:!0,socialLinks:[]},logout:{strategy:"password"},requestPassword:{strategy:"password",socialLinks:[]},resetPassword:{strategy:"password",socialLinks:[]},validation:{password:{required:!0,minLength:6,maxLength:50},email:{required:!0}}},strategies:[R.F3.setup({name:"password",login:{redirect:{success:"/"}},register:{redirect:{success:"/auth"}},logout:{redirect:{success:"/"}},requestPassword:{redirect:{success:"/auth"}},resetPassword:{redirect:{success:"/auth"}}})]}),a.BW0,a.P1.forRoot(),a.j5J.forRoot(),a.j7H.forRoot({closeOnBackdropClick:!0}),a.LW9.forRoot({duration:2e3,position:a.fe3.TOP_RIGHT}),a.OA.forRoot(),a.kmq.forRoot(),a.KdK,a.T2N,a.AE1,N.$,V.m,B._8.forRoot({provide:B._A,useFactory:G.x})]}),c.q6().bootstrapModule(E).catch(o=>console.error(o))}},g=>{g.O(0,[736],()=>{return c=8027,g(g.s=c);var c});g.O()}]);
//# sourceMappingURL=main.200a1f1ebadd57fb.js.map