"use strict";(self.webpackChunkadmin_panel=self.webpackChunkadmin_panel||[]).push([[179],{9345:(g,f,e)=>{var c,n;e.d(f,{F:()=>c}),(n=c||(c={})).PROFILE="profile",n.TEACHER="teacher",n.EVENTS="events",n.ACL="ACL"},3954:(g,f,e)=>{e.d(f,{y:()=>s});var c=e(2560),n=e(7204),t=e(3609);class s{constructor(){this.fireStorage=(0,c.f3M)(n.Ke)}uploadFile(i,v){if(!i)throw new Error("File not provided");const m=(0,n.iH)(this.fireStorage,`${v}/${Date.now()}-${i.name}`),h=(0,n.KV)(m,i);return(0,t.D)(h)}getMedia(i){const v=(0,n.iH)(this.fireStorage,i);return(0,t.D)((0,n.Jt)(v))}}s.\u0275fac=function(i){return new(i||s)},s.\u0275prov=c.Yz7({token:s,factory:s.\u0275fac,providedIn:"root"})},9785:(g,f,e)=>{e.d(f,{Q:()=>h});var c=e(2560),n=e(8873),t=e(6413),s=e(3609),l=e(635),i=e(745),v=e(2673),m=e(9345);class h{constructor(){this.firestore=(0,c.f3M)(n.gg),this.profileCollection=(0,n.hJ)(this.firestore,m.F.PROFILE)}getUsers(){const o=(0,n.IO)(this.profileCollection);return(0,s.D)((0,n.PL)(o)).pipe((0,l.U)(d=>d.docs.map(p=>p.data())))}getUsersNotTeachers(){const o=(0,n.IO)(this.profileCollection,(0,n.ar)("is_blocked","==",!1),(0,n.ar)("is_teacher","==",!1));return(0,s.D)((0,n.PL)(o)).pipe((0,l.U)(d=>d.docs.map(p=>p.data())))}getUsersInList(o){if(!o||!o.length)return(0,i.of)([]);const d=(0,n.IO)(this.profileCollection,(0,n.ar)("uid","in",o));return(0,s.D)((0,n.PL)(d)).pipe((0,l.U)(O=>O.docs.map(y=>y.data())))}getUser(o){const d=(0,n.JU)(this.profileCollection,o);return(0,s.D)((0,n.QT)(d)).pipe((0,l.U)(p=>p.data()))}getUserChanges(o){const d=(0,n.JU)(this.profileCollection,o);return(0,n.KO)(d).pipe((0,l.U)(p=>p.data()))}updateUser(o){const d=(0,n.JU)(this.profileCollection,o.uid);return(0,s.D)((0,n.QT)(d)).pipe((0,v.w)(p=>(o.updated_on=t.EK.now(),p.exists()?(0,s.D)((0,n.r7)(d,o)):(o.created_on=t.EK.now(),(0,s.D)((0,n.pl)(d,o))))))}}h.\u0275fac=function(o){return new(o||h)},h.\u0275prov=c.Yz7({token:h,factory:h.\u0275fac,providedIn:"root"})},8217:(g,f,e)=>{e.d(f,{B:()=>s});var c=e(2560),n=e(745),t=e(3954);class s{constructor(){this.mediaService=(0,c.f3M)(t.y)}transform(i){return i?this.mediaService.getMedia(i):(0,n.of)("")}}s.\u0275fac=function(i){return new(i||s)},s.\u0275pipe=c.Yjl({name:"mediaUrl",type:s,pure:!0})},8915:(g,f,e)=>{e.d(f,{e:()=>t});var c=e(2560),n=e(9785);class t{constructor(){this.userApiService=(0,c.f3M)(n.Q)}getUser(l){return this.userApiService.getUser(l)}getUserChanges(l){return this.userApiService.getUserChanges(l)}}t.\u0275fac=function(l){return new(l||t)},t.\u0275prov=c.Yz7({token:t,factory:t.\u0275fac,providedIn:"root"})},4466:(g,f,e)=>{e.d(f,{m:()=>t});var c=e(4666),n=e(2560);class t{}t.\u0275fac=function(l){return new(l||t)},t.\u0275mod=n.oAB({type:t}),t.\u0275inj=n.cJS({imports:[c.ez]})},8027:(g,f,e)=>{var c=e(4497),n=e(7091),t=e(2560),s=e(4164),l=e(9337);class i{constructor(){this.authService=(0,t.f3M)(s._o),this.router=(0,t.f3M)(n.F0)}canActivate(a,u){return this.authService.isAuthenticated().pipe((0,l.b)(P=>{P||this.router.navigate(["/auth"])}))}}i.\u0275fac=function(a){return new(a||i)},i.\u0275prov=t.Yz7({token:i,factory:i.\u0275fac,providedIn:"root"});const v=[{path:"",loadChildren:()=>e.e(113).then(e.bind(e,9113)).then(r=>r.DashboardModule)},{path:"auth",loadChildren:()=>e.e(845).then(e.bind(e,7845)).then(r=>r.LoginModule)},{path:"profile",loadChildren:()=>e.e(765).then(e.bind(e,4765)).then(r=>r.ProfileModule),canActivate:[i]},{path:"teacher",loadChildren:()=>e.e(42).then(e.bind(e,3042)).then(r=>r.TeacherModule),canActivate:[i]},{path:"calendar",loadChildren:()=>Promise.all([e.e(592),e.e(430)]).then(e.bind(e,3430)).then(r=>r.AppCalendarModule),canActivate:[i]}];class m{}m.\u0275fac=function(a){return new(a||m)},m.\u0275mod=t.oAB({type:m}),m.\u0275inj=t.cJS({imports:[n.Bz.forRoot(v),n.Bz]});var h=e(116),A=e(635),o=e(1008),d=e(4666),p=e(2673),O=e(4874),y=e(745),Z=e(8915),x=e(8217);function K(r,a){if(1&r){const u=t.EpF();t.TgZ(0,"button",4),t.NdJ("click",function(){t.CHM(u);const G=t.oxw();return t.KtG(G.toggle())}),t._UZ(1,"nb-icon",5),t.qZA()}}const F=function(){return["/auth"]};function W(r,a){1&r&&(t.TgZ(0,"a",6),t._UZ(1,"nb-icon",7),t.qZA()),2&r&&t.Q6J("routerLink",t.DdM(1,F))}function z(r,a){if(1&r&&(t._UZ(0,"nb-user",9),t.ALo(1,"async"),t.ALo(2,"mediaUrl")),2&r){const u=a.ngIf;t.Q6J("picture",u.avatar_urls&&t.lcZ(1,2,t.lcZ(2,4,u.avatar_urls[0]))||"")("name",u.first_name+" "+u.last_name)}}function H(r,a){if(1&r&&(t.YNc(0,z,3,6,"nb-user",8),t.ALo(1,"async")),2&r){const u=t.oxw();t.Q6J("ngIf",t.lcZ(1,1,u.user$))}}class C{constructor(){this.sidebarService=(0,t.f3M)(o.lzT),this.nbAuthService=(0,t.f3M)(s._o),this.route=(0,t.f3M)(n.gz),this.router=(0,t.f3M)(n.F0),this.authService=(0,t.f3M)(Z.e),this.isLoggedIn$=this.nbAuthService.isAuthenticated(),this.user$=this.nbAuthService.getToken().pipe((0,p.w)(a=>(console.log({user:a}),this.authService.getUserChanges(a.getPayload().user_id)))),this.title$=this.router.events.pipe((0,h.h)(a=>a instanceof n.m2),(0,O.O)(this.router),(0,p.w)(()=>{let a=this.route.firstChild;for(;a?.firstChild;)a=a.firstChild;return a?.data??(0,y.of)({title:"Admin"})}),(0,A.U)(a=>a.title))}ngOnInit(){this.router.events.pipe((0,h.h)(a=>a instanceof n.m2),(0,l.b)(()=>{this.sidebarService.collapse()})).subscribe()}toggle(){this.sidebarService.toggle()}}function J(r,a){1&r&&(t.TgZ(0,"nb-layout-header",3),t._UZ(1,"app-header"),t.qZA())}C.\u0275fac=function(a){return new(a||C)},C.\u0275cmp=t.Xpm({type:C,selectors:[["app-header"]],decls:10,vars:10,consts:[["nbButton","","status","basic","size","tiny","class","burger",3,"click",4,"ngIf"],[1,"navigation"],["class","login","nbButton","","status","basic","size","tiny",3,"routerLink",4,"ngIf","ngIfElse"],["loggedIn",""],["nbButton","","status","basic","size","tiny",1,"burger",3,"click"],["icon","menu-outline"],["nbButton","","status","basic","size","tiny",1,"login",3,"routerLink"],["icon","person-outline"],[3,"picture","name",4,"ngIf"],[3,"picture","name"]],template:function(a,u){if(1&a&&(t.YNc(0,K,2,0,"button",0),t.ALo(1,"async"),t.TgZ(2,"h1"),t._uU(3),t.ALo(4,"async"),t.qZA(),t.TgZ(5,"div",1),t.YNc(6,W,2,2,"a",2),t.ALo(7,"async"),t.YNc(8,H,2,3,"ng-template",null,3,t.W1O),t.qZA()),2&a){const P=t.MAs(9);t.Q6J("ngIf",t.lcZ(1,4,u.isLoggedIn$)),t.xp6(3),t.Oqu(t.lcZ(4,6,u.title$)),t.xp6(3),t.Q6J("ngIf",!t.lcZ(7,8,u.isLoggedIn$))("ngIfElse",P)}},dependencies:[d.O5,n.rH,o.fMN,o.DPz,o.k0$,d.Ov,x.B],styles:["[_nghost-%COMP%]{display:flex;align-items:center;width:100%}.navigation[_ngcontent-%COMP%]{margin-left:auto}.burger[_ngcontent-%COMP%]{--button-filled-basic-background-color: transparent;--button-filled-basic-hover-background-color: transparent;--button-filled-basic-focus-background-color: transparent;margin-right:16px}.burger[_ngcontent-%COMP%]   nb-icon[_ngcontent-%COMP%]{--button-tiny-icon-size: 20px}.login[_ngcontent-%COMP%]{--button-filled-basic-background-color: transparent;--button-filled-basic-hover-background-color: transparent;--button-filled-basic-focus-background-color: transparent;text-transform:lowercase}.login[_ngcontent-%COMP%]   nb-icon[_ngcontent-%COMP%]{--button-tiny-icon-size: 20px}"],changeDetection:0});class E{constructor(){this.title="admin-panel",this.items=[{title:"\u0413\u043b\u0430\u0432\u043d\u0430\u044f",link:"/"},{title:"\u041f\u0440\u043e\u0444\u0438\u043b\u044c",link:"/profile",pathMatch:"full"},{title:"\u041a\u0430\u043b\u0435\u043d\u0434\u0430\u0440\u044c",link:"/calendar",pathMatch:"full"},{title:"\u0421\u043f\u0438\u0441\u043e\u043a \u043f\u0440\u0435\u043f\u043e\u0434\u0430\u0432\u0430\u0442\u0435\u043b\u0435\u0439",link:"/teacher",pathMatch:"prefix"},{title:"\u0421\u043f\u0438\u0441\u043e\u043a \u0443\u0447\u0435\u043d\u0438\u043a\u043e\u0432",link:"/student",pathMatch:"full"},{title:"\u041a\u043e\u043d\u0442\u0430\u043a\u0442\u044b",link:"/contact",pathMatch:"full"},{title:"\u041e \u043d\u0430\u0441",link:"/about",pathMatch:"full"},{title:"\u0412\u044b\u0439\u0442\u0438",link:"/auth/logout"}],this.router=(0,t.f3M)(n.F0),this.sidebarService=(0,t.f3M)(o.lzT),this.hasHeader$=this.router.events.pipe((0,h.h)(a=>a instanceof n.m2),(0,A.U)(a=>a.url),(0,A.U)(a=>{const u=!a.includes("auth");return u||this.sidebarService.collapse(),u}))}}E.\u0275fac=function(a){return new(a||E)},E.\u0275cmp=t.Xpm({type:E,selectors:[["app-root"]],decls:8,vars:8,consts:[["fixed","",4,"ngIf"],["state","collapsed"],[3,"items"],["fixed",""]],template:function(a,u){1&a&&(t.TgZ(0,"nb-layout"),t.YNc(1,J,2,0,"nb-layout-header",0),t.ALo(2,"async"),t.TgZ(3,"nb-sidebar",1),t._UZ(4,"nb-menu",2),t.qZA(),t.TgZ(5,"nb-layout-column"),t.ALo(6,"async"),t._UZ(7,"router-outlet"),t.qZA()()),2&a&&(t.xp6(1),t.Q6J("ngIf",t.lcZ(2,4,u.hasHeader$)),t.xp6(3),t.Q6J("items",u.items),t.xp6(1),t.ekj("main-layout",t.lcZ(6,6,u.hasHeader$)))},dependencies:[d.O5,n.lC,o.Aqw,o.dP_,o.dmS,o.nZR,o.mBz,C,d.Ov],styles:["nb-sidebar[_ngcontent-%COMP%], nb-sidebar[_ngcontent-%COMP%] > div.main-container[_ngcontent-%COMP%]{transition:width .3s}.main-layout[_ngcontent-%COMP%]{--layout-padding: 1rem}"]});var D=e(9674);const U={firebase:{projectId:"adminpanelfire",appId:"1:459068437086:web:9a4362f897fc83db06bacf",storageBucket:"adminpanelfire.appspot.com",apiKey:"AIzaSyCPPEzrugMj8qBy_XV11rpre81fj_fJGK0",authDomain:"adminpanelfire.firebaseapp.com",messagingSenderId:"459068437086"}};var I=e(3291),L=e(8563),T=e(8873),b=e(4849),S=e(7204),$=e(9906),j=e(9557),R=e(6069),Q=e(1879),N=e(4466),B=e(1242),Y=e(5498);class M{}M.\u0275fac=function(a){return new(a||M)},M.\u0275mod=t.oAB({type:M,bootstrap:[E]}),M.\u0275inj=t.cJS({providers:[{provide:Q.Dh,useValue:U.firebase}],imports:[c.b2,m,(0,D.hX)(()=>(0,D.ZF)(U.firebase)),(0,I.AR)(()=>(0,I.v0)()),(0,L.v8)(()=>(0,L.N8)()),(0,T.Cm)(()=>(0,T.ad)()),(0,b.W$)(()=>(0,b.$C)()),(0,S.Vq)(()=>(0,S.cF)()),$.rT,o.SDF.forRoot({name:"default"}),R.Nk,s.S.forRoot({forms:{login:{strategy:"password",rememberMe:!0,socialLinks:[]},register:{strategy:"password",terms:!0,socialLinks:[]},logout:{strategy:"password"},requestPassword:{strategy:"password",socialLinks:[]},resetPassword:{strategy:"password",socialLinks:[]},validation:{password:{required:!0,minLength:6,maxLength:50},email:{required:!0}}},strategies:[R.F3.setup({name:"password",login:{redirect:{success:"/"}},register:{redirect:{success:"/auth"}},logout:{redirect:{success:"/"}},requestPassword:{redirect:{success:"/auth"}},resetPassword:{redirect:{success:"/auth"}}})]}),o.BW0,o.P1.forRoot(),o.j5J.forRoot(),o.j7H.forRoot({closeOnBackdropClick:!0}),o.LW9.forRoot({duration:2e3,position:o.fe3.TOP_RIGHT}),o.OA.forRoot(),o.kmq.forRoot(),o.KdK,o.T2N,o.AE1,j.$,N.m,B._8.forRoot({provide:B._A,useFactory:Y.x})]}),c.q6().bootstrapModule(M).catch(r=>console.error(r))}},g=>{g.O(0,[736],()=>{return c=8027,g(g.s=c);var c});g.O()}]);
//# sourceMappingURL=main.537b14741c407ac0.js.map