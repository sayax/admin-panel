"use strict";(self.webpackChunkadmin_panel=self.webpackChunkadmin_panel||[]).push([[181],{9181:(q,h,l)=>{l.r(h),l.d(h,{AppCalendarModule:()=>p});var d=l(4666),e=l(2560),o=l(1242),f=l(635),b=l(4633),y=l(9785),D=l(3223);class v{constructor(){this.eventApiService=(0,e.f3M)(D.p),this.userApiService=(0,e.f3M)(y.Q)}getEvents(){return this.eventApiService.getFilteredEvents().pipe((0,f.U)(n=>(console.log("events",n),n.map(t=>this.convertEventToCalendar(t)))))}getUsersByIds(n){return this.userApiService.getUsersInList(n)}convertEventToCalendar(n){return{id:n.uid,start:new Date(n.start_date.toMillis()),end:n.end_date?new Date(n.end_date.toMillis()):void 0,title:n.title,color:b.O[n.colors],allDay:n.allDay,cssClass:n.cssClass,meta:{...n.meta,teacher_uids:n.teacher_uids}}}}v.\u0275fac=function(n){return new(n||v)},v.\u0275prov=e.Yz7({token:v,factory:v.\u0275fac,providedIn:"root"});class s extends o.m${monthViewColumnHeader({date:n,locale:t}){return(0,d.p6)(n,"EEEE","ru")}dayViewHour({date:n,locale:t}){return(0,d.p6)(n,"HH:mm","ru")}weekViewHour({date:n,locale:t}){return this.dayViewHour({date:n,locale:t})}}s.\u0275fac=function(){let a;return function(t){return(a||(a=e.n5z(s)))(t||s)}}(),s.\u0275prov=e.Yz7({token:s,factory:s.\u0275fac});class m extends o.KZ{constructor(n){super(),this.locale=n}month(n){return`<b>${(0,d.p6)(n.start,"HH:mm",this.locale)}</b> ${n.title}`}week(n){return`<b>${(0,d.p6)(n.start,"HH:mm",this.locale)}</b> ${n.title}`}day(n){return`<b>${(0,d.p6)(n.start,"HH:mm",this.locale)}</b> ${n.title}`}}m.\u0275fac=function(n){return new(n||m)(e.LFG(e.soG))},m.\u0275prov=e.Yz7({token:m,factory:m.\u0275fac});var r=l(1008),x=l(3470),M=l(5845);class w{constructor(){this.locale="ru",this.viewChange=new e.vpe,this.viewDateChange=new e.vpe,this.CalendarView=o.wr}}w.\u0275fac=function(n){return new(n||w)},w.\u0275cmp=e.Xpm({type:w,selectors:[["app-calendar-header"]],inputs:{view:"view",viewDate:"viewDate",locale:"locale"},outputs:{viewChange:"viewChange",viewDateChange:"viewDateChange"},decls:14,vars:9,consts:[[1,"header"],[1,"col-md-4"],[1,"btn-group"],["mwlCalendarPreviousView","",1,"btn","btn-primary",3,"view","viewDate","viewDateChange"],["icon","arrow-ios-back-outline"],["mwlCalendarToday","",1,"btn","btn-outline-secondary",3,"viewDate","viewDateChange"],["mwlCalendarNextView","",1,"btn","btn-primary",3,"view","viewDate","viewDateChange"],["icon","arrow-ios-forward-outline"]],template:function(n,t){1&n&&(e.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3),e.NdJ("viewDateChange",function(i){return t.viewDate=i})("viewDateChange",function(){return t.viewDateChange.next(t.viewDate)}),e._UZ(4,"nb-icon",4),e.qZA(),e.TgZ(5,"div",5),e.NdJ("viewDateChange",function(i){return t.viewDate=i})("viewDateChange",function(){return t.viewDateChange.next(t.viewDate)}),e._uU(6," \u0421\u0435\u0433\u043e\u0434\u043d\u044f "),e.qZA(),e.TgZ(7,"div",6),e.NdJ("viewDateChange",function(i){return t.viewDate=i})("viewDateChange",function(){return t.viewDateChange.next(t.viewDate)}),e._UZ(8,"nb-icon",7),e.qZA()()(),e.TgZ(9,"div",1)(10,"h3"),e._uU(11),e.ALo(12,"calendarDate"),e.qZA()(),e._UZ(13,"div",1),e.qZA()),2&n&&(e.xp6(3),e.Q6J("view",t.view)("viewDate",t.viewDate),e.xp6(2),e.Q6J("viewDate",t.viewDate),e.xp6(2),e.Q6J("view",t.view)("viewDate",t.viewDate),e.xp6(4),e.Oqu(e.xi3(12,6,t.viewDate,t.view+"ViewTitle")))},dependencies:[o.YX,o.MG,o.nA,r.fMN,o.vk],styles:[".header[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;align-items:center;margin-bottom:.625rem}.btn-group[_ngcontent-%COMP%]{display:flex;align-items:center}@media screen and (max-width: 768px){.btn-group[_ngcontent-%COMP%]{justify-content:center;flex:1 100%;margin-bottom:.625rem}}.btn[_ngcontent-%COMP%]{-webkit-appearance:none;appearance:none;text-align:center;display:inline-flex;align-items:center;justify-content:center;white-space:nowrap;vertical-align:middle;-webkit-user-select:none;user-select:none;cursor:var(--button-cursor);padding:var(--button-filled-medium-padding);font-family:var(--button-text-font-family);font-weight:var(--button-text-font-weight);font-size:var(--button-medium-text-font-size);line-height:var(--button-medium-text-line-height);border-radius:var(--button-rectangle-border-radius)}.btn-outline[_ngcontent-%COMP%]{border-style:var(--button-outline-border-style);border-width:var(--button-outline-border-width);text-transform:var(--button-outline-text-transform);background-color:var(--button-outline-primary-background-color);border-color:var(--button-outline-primary-border-color);color:var(--button-outline-primary-text-color)}.btn-primary[_ngcontent-%COMP%]{border-style:var(--button-filled-border-style);border-width:var(--button-filled-border-width);text-transform:var(--button-filled-text-transform);background-color:var(--button-filled-primary-background-color);border-color:var(--button-filled-primary-border-color);color:var(--button-filled-primary-text-color)}@media screen and (max-width: 768px){.btn-primary[_ngcontent-%COMP%]{--button-filled-medium-padding: 4px}}.col-md-4[_ngcontent-%COMP%]{flex:0 33%;text-align:center}@media screen and (max-width: 902px){.col-md-4[_ngcontent-%COMP%]{flex:1 100%}}"]});var Z=l(7941);function O(a,n){if(1&a&&(e.TgZ(0,"nb-option",7),e._uU(1),e.qZA()),2&a){const t=n.$implicit;e.Q6J("value",t),e.xp6(1),e.Oqu(t)}}const g=function(){return[]};function T(a,n){if(1&a){const t=e.EpF();e.TgZ(0,"mwl-calendar-month-view",8),e.NdJ("dayClicked",function(i){e.CHM(t);const u=e.oxw();return e.KtG(u.dayClicked(i.day))})("eventClicked",function(i){e.CHM(t);const u=e.oxw(),C=e.MAs(12);return e.KtG(u.openDialog(C,i.event))}),e.ALo(1,"async"),e.qZA()}if(2&a){const t=e.oxw();e.Q6J("viewDate",t.viewDate)("activeDayIsOpen",t.activeDayIsOpen)("events",e.lcZ(1,3,t.events$)||e.DdM(5,g))}}function A(a,n){if(1&a){const t=e.EpF();e.TgZ(0,"mwl-calendar-week-view",9),e.NdJ("eventClicked",function(i){e.CHM(t);const u=e.oxw(),C=e.MAs(12);return e.KtG(u.openDialog(C,i.event))}),e.ALo(1,"async"),e.qZA()}if(2&a){const t=e.oxw();e.Q6J("viewDate",t.viewDate)("events",e.lcZ(1,2,t.events$)||e.DdM(4,g))}}function P(a,n){if(1&a){const t=e.EpF();e.TgZ(0,"mwl-calendar-day-view",9),e.NdJ("eventClicked",function(i){e.CHM(t);const u=e.oxw(),C=e.MAs(12);return e.KtG(u.openDialog(C,i.event))}),e.ALo(1,"async"),e.qZA()}if(2&a){const t=e.oxw();e.Q6J("viewDate",t.viewDate)("events",e.lcZ(1,2,t.events$)||e.DdM(4,g))}}function H(a,n){if(1&a&&(e.TgZ(0,"span"),e._uU(1),e.qZA()),2&a){const t=n.ngIf;e.xp6(1),e.AsE("",null==t?null:t.first_name," ",null==t?null:t.last_name," ")}}function k(a,n){if(1&a&&(e.TgZ(0,"div"),e.YNc(1,H,2,2,"span",12),e.ALo(2,"async"),e.ALo(3,"user"),e.qZA()),2&a){const t=n.$implicit;e.xp6(1),e.Q6J("ngIf",e.lcZ(2,1,e.lcZ(3,3,t)))}}function F(a,n){if(1&a&&(e.TgZ(0,"nb-list-item")(1,"div",10),e._uU(2,"\u041f\u0440\u0435\u043f\u043e\u0434\u0430\u0432\u0430\u0442\u0435\u043b\u0438:"),e.qZA(),e.TgZ(3,"div",11),e.YNc(4,k,4,5,"div",13),e.qZA()()),2&a){const t=e.oxw().$implicit;e.xp6(4),e.Q6J("ngForOf",t.meta.teacher_uids)}}function J(a,n){if(1&a&&(e.TgZ(0,"nb-list-item")(1,"div",10),e._uU(2,"\u041e\u043a\u043e\u043d\u0447\u0430\u043d\u0438\u0435:"),e.qZA(),e.TgZ(3,"div",11),e._uU(4),e.ALo(5,"date"),e.qZA()()),2&a){const t=e.oxw().$implicit;e.xp6(4),e.Oqu(e.xi3(5,1,t.end,"dd.MM.yyyy HH:mm"))}}function S(a,n){if(1&a&&(e.TgZ(0,"nb-card")(1,"nb-card-header"),e._uU(2,"\u0418\u043d\u0444\u043e\u0440\u043c\u0430\u0446\u0438\u044f"),e.qZA(),e.TgZ(3,"nb-card-body")(4,"nb-list")(5,"nb-list-item")(6,"div",10),e._uU(7,"\u041d\u0430\u0437\u0432\u0430\u043d\u0438\u0435:"),e.qZA(),e.TgZ(8,"div",11),e._uU(9),e.qZA()(),e.YNc(10,F,5,1,"nb-list-item",12),e.TgZ(11,"nb-list-item")(12,"div",10),e._uU(13,"\u041d\u0430\u0447\u0430\u043b\u043e:"),e.qZA(),e.TgZ(14,"div",11),e._uU(15),e.ALo(16,"date"),e.qZA()(),e.YNc(17,J,6,4,"nb-list-item",12),e.qZA()()()),2&a){const t=n.$implicit;e.xp6(9),e.Oqu(t.title),e.xp6(1),e.Q6J("ngIf",t.meta.teacher_uids),e.xp6(5),e.Oqu(e.xi3(16,4,t.start,"dd.MM.yyyy HH:mm")),e.xp6(2),e.Q6J("ngIf",t.end)}}class _{constructor(){this.calendarService=(0,e.f3M)(v),this.dialogService=(0,e.f3M)(r.Gln),this.toastr=(0,e.f3M)(r.quB),this.loading=!1,this.activeDayIsOpen=!0,this.CalendarView=o.wr,this.calendarViewOptions=Object.values(o.wr),this.viewDate=new Date,this.view=o.wr.Month}calculateRows(){window.innerWidth<768&&(this.view=o.wr.Day)}ngOnInit(){this.calculateRows(),this.getData()}getData(){this.events$=this.calendarService.getEvents()}selectView(n){this.view=n}openDialog(n,t){this.ref=this.dialogService.open(n,{context:t})}dayClicked({date:n,events:t}){(0,x.Z)(n,this.viewDate)&&((0,M.Z)(this.viewDate,n)&&!0===this.activeDayIsOpen||0===t.length?this.activeDayIsOpen=!1:this.activeDayIsOpen=!0,this.viewDate=n)}}_.\u0275fac=function(n){return new(n||_)},_.\u0275cmp=e.Xpm({type:_,selectors:[["app-calendar"]],hostBindings:function(n,t){1&n&&e.NdJ("resize",function(i){return t.calculateRows(i)},!1,e.Jf7)},features:[e._Bn([{provide:o.m$,useClass:s},{provide:o.KZ,useClass:m}])],decls:13,vars:8,consts:[["name","view",1,"desktop",3,"selected","selectedChange"],[3,"value",4,"ngFor","ngForOf"],[3,"ngSwitch"],[3,"view","viewDate","viewChange","viewDateChange"],["precision","minutes",3,"viewDate","activeDayIsOpen","events","dayClicked","eventClicked",4,"ngSwitchCase"],["precision","minutes",3,"viewDate","events","eventClicked",4,"ngSwitchCase"],["showInfo",""],[3,"value"],["precision","minutes",3,"viewDate","activeDayIsOpen","events","dayClicked","eventClicked"],["precision","minutes",3,"viewDate","events","eventClicked"],[1,"title"],[1,"value"],[4,"ngIf"],[4,"ngFor","ngForOf"]],template:function(n,t){1&n&&(e.TgZ(0,"nb-layout")(1,"nb-layout-column")(2,"nb-card")(3,"nb-card-header")(4,"nb-select",0),e.NdJ("selectedChange",function(i){return t.selectView(i)}),e.YNc(5,O,2,2,"nb-option",1),e.qZA()(),e.TgZ(6,"nb-card-body",2)(7,"app-calendar-header",3),e.NdJ("viewChange",function(i){return t.view=i})("viewDateChange",function(i){return t.viewDate=i}),e.qZA(),e.YNc(8,T,2,6,"mwl-calendar-month-view",4),e.YNc(9,A,2,5,"mwl-calendar-week-view",5),e.YNc(10,P,2,5,"mwl-calendar-day-view",5),e.qZA()(),e.YNc(11,S,18,7,"ng-template",null,6,e.W1O),e.qZA()()),2&n&&(e.xp6(4),e.Q6J("selected",t.view),e.xp6(1),e.Q6J("ngForOf",t.calendarViewOptions),e.xp6(1),e.Q6J("ngSwitch",t.view),e.xp6(1),e.Q6J("view",t.view)("viewDate",t.viewDate),e.xp6(1),e.Q6J("ngSwitchCase","month"),e.xp6(1),e.Q6J("ngSwitchCase","week"),e.xp6(1),e.Q6J("ngSwitchCase","day"))},dependencies:[d.sg,d.O5,d.RF,d.n9,o.GH,o.TK,o.Se,r.Aqw,r.dP_,r.Asz,r.yKW,r.ndF,r.rs,r.q51,r.zP_,r.qBV,w,d.Ov,d.uU,Z.d],styles:["[_nghost-%COMP%]   nb-card-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between}[_nghost-%COMP%]     .cal-week-view .cal-time-events .cal-day-column{margin-right:10px}[_nghost-%COMP%]     .cal-week-view .cal-hour{width:calc(100% + 10px)}[_nghost-%COMP%]     mwl-calendar-month-view .cal-event-action{margin:0 10px;color:var(--button-filled-primary-text-color)}[_nghost-%COMP%]     mwl-calendar-week-view .cal-event-action, [_nghost-%COMP%]     mwl-calendar-day-view .cal-event-action{margin-right:4px;color:var(--button-outline-primary-text-color)}nb-list-item[_ngcontent-%COMP%]{--list-item-padding: .625rem 0;--list-item-divider-width: 0;display:flex;justify-content:space-between;align-items:flex-start}nb-list-item[_ngcontent-%COMP%]   div[_ngcontent-%COMP%]{width:200px}nb-list-item[_ngcontent-%COMP%]   div[_ngcontent-%COMP%]:last-child{text-align:right}nb-card-footer[_ngcontent-%COMP%]{display:flex;justify-content:space-between}@media screen and (max-width: 768px){nb-card-header[_ngcontent-%COMP%]{flex-direction:column}nb-card-header[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{margin-bottom:.5rem}.desktop[_ngcontent-%COMP%]{display:none}nb-list-item[_ngcontent-%COMP%]{flex-direction:column}nb-list-item[_ngcontent-%COMP%]   div[_ngcontent-%COMP%]{text-align:center}nb-list-item[_ngcontent-%COMP%]   div[_ngcontent-%COMP%]:last-child{text-align:center}}"]});var E=l(7091),N=l(4466);class p{}p.\u0275fac=function(n){return new(n||p)},p.\u0275mod=e.oAB({type:p}),p.\u0275inj=e.cJS({imports:[d.ez,o._8,r.BW0,r.zyh,r.T2N,r.IIj,r.KdK,r.COg,r.KdK,N.m,E.Bz.forChild([{path:"",component:_,data:{title:"\u0420\u0430\u0441\u043f\u0438\u0441\u0430\u043d\u0438\u0435"}}])]})}}]);
//# sourceMappingURL=181.a10bdb1e710e1046.js.map